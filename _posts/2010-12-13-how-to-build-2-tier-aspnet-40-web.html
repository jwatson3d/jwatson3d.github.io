---
title: How To Build a 2-Tier ASP.NET 4.0 Web Site–Part 2
date: '2010-12-13T06:00:00.000-05:00'
author: John Watsion
classes: wide
tags:
- Tutorial
- VisualStudio
- IIS 7.5
- ASP.NET 4.0
- Win7
modified_time: '2010-12-13T06:00:10.169-05:00'
thumbnail: http://lh3.ggpht.com/_BvH8o_BvG-4/TQVRQsWfhcI/AAAAAAAAALs/haCB7Bv8o3o/s72-c/2010-12-01_231902_thumb.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-2811308028656623966.post-8455594432442793951
blogger_orig_url: http://pragmatic-software.blogspot.com/2010/12/how-to-build-2-tier-aspnet-40-web.html
---

<a href="http://pragmatic-software.blogspot.com/2010/12/how-to-build-2-tier-aspnet-web-sitepart.html">Last time</a> we built a new ASP.NET 4.0 empty web site and set up the Default.aspx web form with a simple prompt for customer number. Now we’ll create a Result.aspx to display the results of a query from the <a href="http://sqlserversamples.codeplex.com/" target="_blank">AdventureWorks</a> sample database. Don’t be alarmed at the length of this part, I simply took lots of screenshots along the way to make it easy to follow.<br /><ol><li>Add a new page named <strong>Result.aspx</strong> as described previously in <a href="http://pragmatic-software.blogspot.com/2010/12/how-to-build-2-tier-aspnet-web-sitepart.html#addwebform">step 3</a>:<br /><a href="http://lh5.ggpht.com/_BvH8o_BvG-4/TQVRQYzKTsI/AAAAAAAAALo/RJ29Z7lmsfY/s1600-h/2010-12-01_231902%5B2%5D.png"><img alt="2010-12-01_231902" border="0" height="170" src="http://lh3.ggpht.com/_BvH8o_BvG-4/TQVRQsWfhcI/AAAAAAAAALs/haCB7Bv8o3o/2010-12-01_231902_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_231902" width="244" /></a><br /></li><li>Switch the content area to “split” view using the tabs at the bottom, located the <strong>GridView</strong> control in the toolbox and drag it onto the design surface:<br /><a href="http://lh5.ggpht.com/_BvH8o_BvG-4/TQVRQxEMosI/AAAAAAAAALw/mmUrPzq5ODY/s1600-h/2010-12-01_231937%5B2%5D.png"><img alt="2010-12-01_231937" border="0" height="189" src="http://lh4.ggpht.com/_BvH8o_BvG-4/TQVRRP22F4I/AAAAAAAAAL0/EWagKvuLujw/2010-12-01_231937_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_231937" width="244" /></a><br /></li><li>To configure the data source click on the small arrowhead in the upper right section of the grid view control to expose the configuration pane as shown here:<br /><a href="http://lh6.ggpht.com/_BvH8o_BvG-4/TQVRRVKP0YI/AAAAAAAAAL4/Muh9hZq4wfE/s1600-h/2010-12-01_232004%5B2%5D.png"><img alt="2010-12-01_232004" border="0" height="74" src="http://lh6.ggpht.com/_BvH8o_BvG-4/TQVRRrB2wbI/AAAAAAAAAL8/nLCpU46yEUI/2010-12-01_232004_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232004" width="244" /></a><br /></li><li>Click the drop-down control next to “Choose Data Source:” above and select “<strong>&lt;New data source…&gt;</strong>” which will launch the Data Source Configuration Wizard:<br /><a href="http://lh6.ggpht.com/_BvH8o_BvG-4/TQVRR9o5tKI/AAAAAAAAAMA/BsXkrgEZUx4/s1600-h/2010-12-01_232044%5B2%5D.png"><img alt="2010-12-01_232044" border="0" height="182" src="http://lh6.ggpht.com/_BvH8o_BvG-4/TQVRSKi80II/AAAAAAAAAME/_GKa8zWAeLg/2010-12-01_232044_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232044" width="244" /></a><br />As shown above, select the <strong>SQL Database</strong> icon and input a meaningful name (or accept the default).<br /></li><li>Clicking “OK” will bring up the next dialog to choose a database connection where you’ll select the <strong>New Connection</strong> button:<br /><a href="http://lh3.ggpht.com/_BvH8o_BvG-4/TQVRSS2MpWI/AAAAAAAAAMI/oYPyyZDbs0U/s1600-h/2010-12-01_232107%5B2%5D.png"><img alt="2010-12-01_232107" border="0" height="64" src="http://lh3.ggpht.com/_BvH8o_BvG-4/TQVRSk-DbjI/AAAAAAAAAMM/TWF2nosz4BY/2010-12-01_232107_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232107" width="244" /></a><br /></li><li>In the Add Connection dialog specify the name of the SQL server – this can be (local) if SQL (or SQL Express) is installed on the same machine you’re working on or another machine:<br /><a href="http://lh4.ggpht.com/_BvH8o_BvG-4/TQVRSyP7udI/AAAAAAAAAMQ/VvKjtyx6J8Y/s1600-h/2010-12-01_232132%5B2%5D.png"><img alt="2010-12-01_232132" border="0" height="244" src="http://lh4.ggpht.com/_BvH8o_BvG-4/TQVRTG_ORZI/AAAAAAAAAMU/8ToyoMo-mEk/2010-12-01_232132_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232132" width="168" /></a><br />For (local) machines you should be able to the leave the <strong>Log on to the server</strong> default as <strong>Use Windows Authentication</strong>. For remote machines you might have to switch to <strong>Use SQL Server Authentication</strong> and supply a user name / password combination – unless your machine is part of a Windows domain as is usually the case in corporate environments. The selected database name should be <strong>AdventureWorksDW2008</strong> or <strong>AdventureWorksDW2008R2</strong> depending on which version you installed.<br /></li><li>Press the Test Connection button to verify that these settings work. If the test fails seek help or otherwise resolve the problem before continuing.<br /><a href="http://lh6.ggpht.com/_BvH8o_BvG-4/TQVRTUw7x2I/AAAAAAAAAMY/rhN8AHbbfYI/s1600-h/2010-12-01_232206%5B2%5D.png"><img alt="2010-12-01_232206" border="0" height="163" src="http://lh5.ggpht.com/_BvH8o_BvG-4/TQVRTvdNubI/AAAAAAAAAMc/jiYOkUEvSoE/2010-12-01_232206_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232206" width="244" /></a><br /></li><li>Save the Connection string and continue:<br /><a href="http://lh4.ggpht.com/_BvH8o_BvG-4/TQVRUKqeZEI/AAAAAAAAAMg/XePmvpxAxaY/s1600-h/2010-12-01_232243%5B2%5D.png"><img alt="2010-12-01_232243" border="0" height="197" src="http://lh4.ggpht.com/_BvH8o_BvG-4/TQVRUeDtC1I/AAAAAAAAAMk/Jytd3Wqd4t0/2010-12-01_232243_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232243" width="244" /></a><br /></li><li>Choose the <strong>DimCustomer</strong> table for the Select statement:<br /><a href="http://lh5.ggpht.com/_BvH8o_BvG-4/TQVRUiqFcVI/AAAAAAAAAMo/ON8BRzphcAs/s1600-h/2010-12-01_232304%5B2%5D.png"><img alt="2010-12-01_232304" border="0" height="188" src="http://lh5.ggpht.com/_BvH8o_BvG-4/TQVRVCTTQ-I/AAAAAAAAAMs/B4LE0PTyw3w/2010-12-01_232304_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232304" width="244" /></a><br /></li><li>Choose <strong>FirstName</strong>, <strong>MiddleName</strong>, <strong>LastName</strong>, <strong>BirthDate</strong>, <strong>Gender</strong>, and <strong>Phone</strong> for columns and click the <strong><u>W</u>HERE</strong>… button:<br /><a href="http://lh5.ggpht.com/_BvH8o_BvG-4/TQVRVHVDxWI/AAAAAAAAAMw/Fmh1Qyun6uQ/s1600-h/2010-12-01_232340%5B2%5D.png"><img alt="2010-12-01_232340" border="0" height="125" src="http://lh3.ggpht.com/_BvH8o_BvG-4/TQVRVt7DkPI/AAAAAAAAAM0/laAna2HhAn0/2010-12-01_232340_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232340" width="244" /></a><br /></li><li>Select the <strong>CustomerKey</strong> as the Column name to filter on, specify <strong>Form</strong> as the source (i.e. use Request.Form collection value) then type the name previously used as the ID for the Textbox control in <a href="http://pragmatic-software.blogspot.com/2010/12/how-to-build-2-tier-aspnet-web-sitepart.html#addtextbox">step 5</a>:<br /><a href="http://lh3.ggpht.com/_BvH8o_BvG-4/TQVRVzn2x7I/AAAAAAAAAM4/PITrJxkG47c/s1600-h/2010-12-01_232408%5B2%5D.png"><img alt="2010-12-01_232408" border="0" height="142" src="http://lh4.ggpht.com/_BvH8o_BvG-4/TQVRWM7S-3I/AAAAAAAAAM8/otHxx_EPez4/2010-12-01_232408_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232408" width="244" /></a><br /></li><li>After clicking the Add button you’ll see the WHERE clause that has been constructed and you can click Test Query to verify that the SELECT statement executes properly as expected:<br /><a href="http://lh4.ggpht.com/_BvH8o_BvG-4/TQVRWeJJ5fI/AAAAAAAAANA/y7-0HDVCjjM/s1600-h/2010-12-01_232425%5B2%5D.png"><img alt="2010-12-01_232425" border="0" height="78" src="http://lh4.ggpht.com/_BvH8o_BvG-4/TQVRWSy59AI/AAAAAAAAANE/lRDCCTvJsnU/2010-12-01_232425_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232425" width="244" /></a><br /><a href="http://lh5.ggpht.com/_BvH8o_BvG-4/TQVRWoOJamI/AAAAAAAAANI/pckXuAb8ikM/s1600-h/2010-12-01_232444%5B2%5D.png"><img alt="2010-12-01_232444" border="0" height="179" src="http://lh6.ggpht.com/_BvH8o_BvG-4/TQVRXK8MVdI/AAAAAAAAANM/CS3Glfvs1bo/2010-12-01_232444_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232444" width="244" /></a><br /><a href="http://lh5.ggpht.com/_BvH8o_BvG-4/TQVRXVf2w8I/AAAAAAAAANQ/AIDe16oZIqs/s1600-h/2010-12-01_232456%5B2%5D.png"><img alt="2010-12-01_232456" border="0" height="164" src="http://lh4.ggpht.com/_BvH8o_BvG-4/TQVRXiiw7wI/AAAAAAAAANU/dyKc-uS47TU/2010-12-01_232456_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232456" width="244" /></a><br /><a href="http://lh5.ggpht.com/_BvH8o_BvG-4/TQVRX5_AJ9I/AAAAAAAAANY/n6T82G-fPuo/s1600-h/2010-12-01_232508%5B2%5D.png"><img alt="2010-12-01_232508" border="0" height="197" src="http://lh5.ggpht.com/_BvH8o_BvG-4/TQVRYAzDaqI/AAAAAAAAANc/9wSUcmkprJk/2010-12-01_232508_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232508" width="244" /></a><br /></li><li>After clicking the Add button you’ll see the WHERE clause that has been constructed and you can click Test Query to verify that the SELECT statement executes properly as expected:<br /><a href="http://lh3.ggpht.com/_BvH8o_BvG-4/TQVRYxdS7ZI/AAAAAAAAANg/TzRYjloNBZY/s1600-h/2010-12-01_232531%5B2%5D.png"><img alt="2010-12-01_232531" border="0" height="175" src="http://lh6.ggpht.com/_BvH8o_BvG-4/TQVRZUrXGZI/AAAAAAAAANk/m5IIBsDNWT4/2010-12-01_232531_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232531" width="244" /></a><br /></li><li>Save your work then move back to Default.aspx to wire the Submit button to post back to the new Result.aspx page:<br /><a href="http://lh6.ggpht.com/_BvH8o_BvG-4/TQVRZgK64bI/AAAAAAAAANo/hC3zOHKHsQg/s1600-h/2010-12-01_232823%5B2%5D.png"><img alt="2010-12-01_232823" border="0" height="103" src="http://lh3.ggpht.com/_BvH8o_BvG-4/TQVRZrRPJRI/AAAAAAAAANs/sCc65kvMPQA/2010-12-01_232823_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232823" width="244" /></a><br />Clicking the ellipsis next to the <strong>PostBackUrl</strong> brings up a list of pages within the project where you can select <strong>Result.aspx</strong>:<br /><a href="http://lh4.ggpht.com/_BvH8o_BvG-4/TQVRaPneA_I/AAAAAAAAANw/78i5y5yvIxQ/s1600-h/2010-12-01_232832%5B2%5D.png"><img alt="2010-12-01_232832" border="0" height="149" src="http://lh6.ggpht.com/_BvH8o_BvG-4/TQVRacVXM8I/AAAAAAAAAN0/Qu3BfQBAH10/2010-12-01_232832_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232832" width="244" /></a><br /></li><li>Right-click on <strong>Default.aspx</strong> in Solution Explorer and set it as the start page:<br /><a href="http://lh3.ggpht.com/_BvH8o_BvG-4/TQVRaRpUv8I/AAAAAAAAAN4/deVkrpfzNR8/s1600-h/2010-12-01_232659%5B2%5D.png"><img alt="2010-12-01_232659" border="0" height="235" src="http://lh5.ggpht.com/_BvH8o_BvG-4/TQVRa9M0c-I/AAAAAAAAAN8/jA-qlRykpLQ/2010-12-01_232659_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232659" width="244" /></a><br /></li><li>Finally, hit “F5” to test the site:<br /><a href="http://lh3.ggpht.com/_BvH8o_BvG-4/TQVRbBM5i9I/AAAAAAAAAOA/p5H9zUeSd-o/s1600-h/2010-12-01_232735%5B2%5D.png"><img alt="2010-12-01_232735" border="0" height="143" src="http://lh6.ggpht.com/_BvH8o_BvG-4/TQVRbRzf_mI/AAAAAAAAAOE/S6NrT4TClFk/2010-12-01_232735_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232735" width="244" /></a><br /><a href="http://lh3.ggpht.com/_BvH8o_BvG-4/TQVRbt2reEI/AAAAAAAAAOI/oyzMzqlsVZg/s1600-h/2010-12-01_232859%5B2%5D.png"><img alt="2010-12-01_232859" border="0" height="93" src="http://lh3.ggpht.com/_BvH8o_BvG-4/TQVRb6OeO9I/AAAAAAAAAOM/MeCMIchht_I/2010-12-01_232859_thumb.png?imgmax=800" style="background-image: none; border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: inline; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="2010-12-01_232859" width="244" /></a></li></ol><br />Note the following:<br /><br /><ul><li>The port number shown above (:1483) will be different – Visual Studio generates a random port number for each web project.</li><li>Visual Studio contains (hosts) a built-in “mini” web server functionally identical to the full-blown web server IIS (Internet Information Server). However, this server is restricted to a minimum number of browser connections and can only be accessed via a web browser on the same machine Visual Studio is on.</li></ul><br /><div><br /></div><br />At this point we’ve got a working 2-tier ASP.NET 4.0 web site that’s prompting for a customer, querying a SQL database and displaying the results in a grid (tabular) format. Next we’ll setup IIS 7.5 on Windows 7 then deploy the site out to a commercial web server.
