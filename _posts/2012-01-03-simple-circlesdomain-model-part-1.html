---
title: Simple Circles–Domain Model (Part 1)
date: '2012-01-03T05:44:00.000-05:00'
author: John Watson
classes: wide
excerpt: This post is part of a series on building a simple to use web-based contact and customer relationship management application. The goal is to support various audiences including businesses, teams, clubs, religious organizations, etc. Thus, it is important that the domain model be flexible enough to allow various combinations of entities to be used to support these use cases...
tags:
- Patterns
- MVC
- Tutorial
- NHibernate
modified_time: '2012-01-03T05:46:11.130-05:00'
thumbnail: http://lh6.ggpht.com/-5-jU3nWNjug/TwEIhyT5ifI/AAAAAAAAAX0/CNvrvidoV60/s72-c/Simple-Circles---Party-Concept_thumb.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-2811308028656623966.post-5038081416510873071
blogger_orig_url: http://pragmatic-software.blogspot.com/2012/01/simple-circlesdomain-model-part-1.html
---

This post is part of a <a href="http://pragmatic-software.blogspot.com/2012/01/simple-circlesintroduction.html">series</a> on building a simple to use web-based contact and customer relationship management application. The goal is to support various audiences including businesses, teams, clubs, religious organizations, etc. Thus, it is important that the domain model be flexible enough to allow various combinations of entities to be used to support these use cases. For example, in a <a href="http://en.wikipedia.org/wiki/Business-to-business" target="_blank">B2B</a> scenario the notion of a person or a household will not likely be center stage whereas businesses will be. However, a club or sports team will likely interact with individuals and possibly households but not likely with businesses.<br /><h2>Models</h2><a href="http://lh4.ggpht.com/-b9oMCUMbNMM/TwEIhWFRpQI/AAAAAAAAAXs/wEhns3KOC1c/s1600-h/Simple-Circles---Party-Concept2.png"><img align="right" alt="Simple Circles - Party Concept" border="0" height="200" src="http://lh6.ggpht.com/-5-jU3nWNjug/TwEIhyT5ifI/AAAAAAAAAX0/CNvrvidoV60/Simple-Circles---Party-Concept_thumb.png?imgmax=800" style="background-image: none; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px; display: inline; float: right; margin-bottom: 0px; margin-left: 5px; margin-right: 0px; margin-top: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="Simple Circles - Party Concept" width="190" /></a>Modeling entities such as Person, Household, and Organization come to mind immediately. However, the “Party” model has existed for many years as a way to generically model the relationships between various parties. The figure to the right illustrates graphically this concept. Person, Household, and Organization are all types of parties. This approach also allows reuse of relationships such as notes, postal addresses, and communication channels across all types of parties. Rather that duplicating logic, storage mechanisms and business rules for each entity this approach follows the Don’t Repeat Yourself (<a href="http://en.wikipedia.org/wiki/Don't_repeat_yourself" target="_blank">DRY</a>) principle.<br /><br /><a href="http://lh3.ggpht.com/-YY_yLzvY93k/TwEIiFPxutI/AAAAAAAAAX4/susTbkORwlI/s1600-h/Simple-Circles---Party-Class-Diagram%25255B1%25255D.png"><img align="right" alt="Simple Circles - Party Class Diagram" border="0" height="134" src="http://lh6.ggpht.com/-HmUplfjbC_Q/TwEIitICT-I/AAAAAAAAAYA/N1KKkcV_pAs/Simple-Circles---Party-Class-Diagram.png?imgmax=800" style="background-image: none; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px; display: inline; float: right; margin-bottom: 0px; margin-left: 5px; margin-right: 0px; margin-top: 5px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="Simple Circles - Party Class Diagram" width="200" /></a>Transferring the conceptual model to a physical one is accomplished using inheritance as shown in the class diagram to the right. The Party class is an abstract base class containing a PartyId unique identifier and a PartyName. Person, Household, and Organization all inherit these base properties supplementing them with specific properties they contain. Notice that the base class contains relationships to Party Note, Postal Address and Channel Address as well as to Party Type. Through inheritance all child subtypes also inherit these relationships without having to explicitly code them three different times (DRY!). Using a separate Party Type allows classifying individual party instances which supports filtering the parties in lists, views, etc.<br /><h2>Classes</h2>Here is the code for the Party class which realizes the class diagram shown above:<br /><pre class="c-sharp" name="code">namespace Circles.DomainModel<br />{<br />  using System;<br />  using System.Collections.Generic;<br /><br />  /// &lt;summary&gt;<br />  /// An abstract class representing any 'Party' that can be interacted with.<br />  /// &lt;/summary&gt;<br />  public abstract class Party<br />  {<br />    private ISet&lt;ChannelAddress&gt; channelAddresses = new HashSet&lt;ChannelAddress&gt;();<br />    private ISet&lt;PartyNote&gt; notes = new HashSet&lt;PartyNote&gt;();<br />    private ISet&lt;PostalAddress&gt; postalAddresses = new HashSet&lt;PostalAddress&gt;();<br /><br />    /// &lt;summary&gt;<br />    /// Gets or sets the unique identifier of the Party instance.<br />    /// &lt;/summary&gt;<br />    public Guid PartyId { get; set; }<br /><br />    /// &lt;summary&gt;<br />    /// Gets or sets the name of the Party instance.<br />    /// &lt;/summary&gt;<br />    public virtual string PartyName { get; set; }<br /><br />    /// &lt;summary&gt;<br />    /// Gets or sets the PartyType of the Party instance.<br />    /// &lt;/summary&gt;<br />    public virtual PartyType PartyType { get; set; }<br /><br />    /// &lt;summary&gt;<br />    /// Gets or sets the Notes associated with the Party instance.<br />    /// &lt;/summary&gt;<br />    public ISet&lt;ChannelAddress&gt; ChannelAddresses<br />    {<br />      get { return this.channelAddresses; }<br />      set { this.channelAddresses = value; }<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Gets or sets the Notes associated with the Party instance.<br />    /// &lt;/summary&gt;<br />    public ISet&lt;PartyNote&gt; Notes<br />    {<br />      get { return this.notes; }<br />      set { this.notes = value; }<br />    }<br /><br />    /// &lt;summary&gt;<br />    /// Gets or sets the Notes associated with the Party instance.<br />    /// &lt;/summary&gt;<br />    public ISet&lt;PostalAddress&gt; PostalAddresses<br />    {<br />      get { return this.postalAddresses; }<br />      set { this.postalAddresses = value; }<br />    }<br />  }<br />}</pre><br />Note that this is not the “finished product” but rather an early version along the way. Future articles will refine this further.<br /><br />The source code for this article can be downloaded from <a href="http://simplecircles.codeplex.com/SourceControl/changeset/changes/0e3454db36be#" target="_blank">here</a>.<br /><br />Next we’ll look at persistence of this model.
