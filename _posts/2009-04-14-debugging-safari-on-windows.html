---
layout: post
title: Debugging Safari on Windows
date: '2009-04-14T21:29:00.000-04:00'
author: John
tags:
- Safari
- Apple
modified_time: '2010-09-04T11:10:44.812-04:00'
thumbnail: http://lh3.ggpht.com/_BvH8o_BvG-4/TIJhbbFnexI/AAAAAAAAAEY/zE2CFbA8kHY/s72-c/Safari_AdvancedPrefs_thumb1.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-2811308028656623966.post-4550939973510773348
blogger_orig_url: http://pragmatic-software.blogspot.com/2009/04/debugging-safari-on-windows.html
---

<p>Truthfully, I had strongly considered titling this post “Drive by blogging” as a nod to a drive by shooting or “Blog rage” in deference to road rage because that’s how I felt this morning. I briefly considered “Why Safari sucks” as well. The fact is that compared to debugging under Internet Explorer or Firefox, Safari is still in the dark ages.</p> <p><a href="http://lh3.ggpht.com/_BvH8o_BvG-4/TIJhZgjSOJI/AAAAAAAAAEU/zT8-lvqoP3w/s1600-h/Safari_AdvancedPrefs3.png"><img style="border-right-width: 0px; margin: 0px 0px 5px 5px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Safari_AdvancedPrefs" border="0" alt="Safari_AdvancedPrefs" align="right" src="http://lh3.ggpht.com/_BvH8o_BvG-4/TIJhbbFnexI/AAAAAAAAAEY/zE2CFbA8kHY/Safari_AdvancedPrefs_thumb1.png?imgmax=800" width="244" height="145"></a>Searching for “Safari debug JavaScript” easily turns up secret incantations for enabling the hidden Developer’s menu and you think you’re onto something only to be let down. Okay, that’s not totally fair – apparently you had to hunt for preferences and edit an XML file or type in an undocumented command string but now it’s found on the Edit | Preferences dialog under the Advanced “section” (or is that “tab” or “button” in Apple-speak – hard to tell with that non-intuitive dialog).</p> <p><a href="http://lh6.ggpht.com/_BvH8o_BvG-4/TIJhbv19F4I/AAAAAAAAAEc/bmXUta3wLSg/s1600-h/Safari_DeveloperMenu3.png"><img style="border-right-width: 0px; margin: 0px 5px 5px 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Safari_DeveloperMenu" border="0" alt="Safari_DeveloperMenu" align="left" src="http://lh4.ggpht.com/_BvH8o_BvG-4/TIJhdJWZhlI/AAAAAAAAAEg/UFo446aTKBY/Safari_DeveloperMenu_thumb1.png?imgmax=800" width="219" height="244"></a> With the “Show Develop menu in menu bar” checked, you’ll be briefly pleased at the shiny new menu shown here on the left. I’ve highlighted the most promising options. Web Inspector is a nice little DOM inspector and even shows the JavaScript files currently loaded – same as Firefox/Firebug and IE/DeveloperTools. The Error Console is pretty standard and the Network Timeline is a very nice feature.</p> <p>My issue with all this glitz is that IT’S FREAKIN’ NEAR USELESS!!! You can’t *DEBUG* JavaScript in a way that is considered modern, standard practice today. Unlike Internet Explorer with it’s developer add-in or Firefox’ Firebug add-in, you can’t set breakpoints and step through code, nor can you inspect variable values nor see a call stack to figure out where you’ve come from.</p> <p>In fact, the above mentioned search yields as its number one result the <a href="http://developer.apple.com/internet/safari/faq.html#anchor14" target="_blank">Safari Developer FAQ</a> which specifically answers the question - it’s #14 on the FAQ list. I’ll quote a bit of it <a href="/Shared/NAdv/NAdv_v1.3.zip" target="_blank">here</a>: “Safari 1.3 and above supports explicit logging of arbitrary information … by using <code>window.console.log()</code> in your JavaScript. All messages are routed to the JavaScript Console window and show up nicely in a dark green, to easily differentiate themselves from JavaScript exceptions.”</p> <p>Gee, it bring tears to my eyes to think that 25 years ago when I first started programming in RPG II and Cobol-74 on IBM systems I could carefully insert debug logging code into my program and observe the values of variables when I re-ran the program and managed to bring it to the same state it was in that caused me to consider there’s a bug in there somewhere. It’s really great to know that the Apple team hasn’t strayed too far from the tried and true basics that have worked for so long. No wonder Safari is such a <a href="http://marketshare.hitslink.com/report.aspx?qprid=0&amp;qptimeframe=M&amp;qpsp=120&amp;qpnp=3&amp;qpmr=100&amp;qpdt=1&amp;qpct=3&amp;qpf=1" target="_blank">distant third</a> in the browser market with the rest of the niche players – developers HATE working with it!!</p> <p></p> <p></p> <p>On to my real gripe – if you really dig hard, you’ll come across the <a href="http://webkit.org" target="_blank">WebKit</a> underneath Safari with <a href="http://webkit.org/building/tools.html" target="_blank">instructions</a> on how to build and debug it. There’s two itsy, bitsy things they don’t tell you in the Windows instructions…</p> <ol> <li>If you already have Cygwin for other things, forget about it. Rip it out and install their <a href="http://svn.webkit.org/repository/webkit/trunk/WebKitTools/CygwinDownloader/cygwin-downloader.zip" target="_blank">customized version</a> mentioned in step 3. They’re not explicit about that and you will waste time otherwise. While I applaud them for making it somewhat turnkey, at least point out that they’ve got a custom configured version and that it’s the only way you’ll get it to work. Their <a href="http://trac.webkit.org/wiki/BuildingOnWindows" target="_blank">wiki</a> has a link to the “list” of packages (really just a pointer to the Perl source for the installer) but adding those packages to an existing Cygwin install still doesn’t work.  <li>The second dirty little secret they forgot to spell out…you *MUST* download the source under your home directory, e.g. /cygwin/home/&lt;username&gt;/WebKit. So /WebKit or /Src/WebKit, or /Repo/WebKit …none of these are allowed – there’s only one path structure that will work and it’s theirs. There’s plenty of path references inside their Perl scripts that assume this directory structure and will only work properly with it. I don’t necessarily have a problem with that, but I do have a problem with them not taking the extra minute to point this out clearly so as not to waste the time of others. </li></ol> <p>If you make either of these mistakes (or both, as I did) you will waste a lot of time and effort chasing missing things, strange error messages, and generally getting frustrated. Welcome to the wonderful world of free, open source projects – you get what you pay for…nothing!</p> <p>Now on to debugging a JavaScript library that works beautifully under Internet Explorer and Firefox but not so much under he-who-must-not-be-named-browser.</p> <p>&nbsp;</p> <p>P.S. Did you catch the hidden message? If you want to debug JavaScript running in Safari you need to download the source code for the browser, configure a proper build environment, then run the browser in the debugger. Ooh-rah! Only way to be productive.</p>  