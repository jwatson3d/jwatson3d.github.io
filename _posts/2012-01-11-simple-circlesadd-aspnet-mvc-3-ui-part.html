---
layout: post
title: Simple Circles–Add an ASP.NET MVC 3 UI (Part 4a)
date: '2012-01-11T18:39:00.000-05:00'
author: John
tags:
- CodeGeneration
- MVC
- Tutorial
- Scaffold
- ASP.NET 4.0
- OSS
modified_time: '2012-01-11T18:39:44.319-05:00'
thumbnail: http://lh5.ggpht.com/-WD0dWewT6_M/TwHS-wWEQYI/AAAAAAAAAY0/lzTFRXaEL9I/s72-c/Simple-Circles---MVC-Scaffolding_thu.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-2811308028656623966.post-1197125778539225902
blogger_orig_url: http://pragmatic-software.blogspot.com/2012/01/simple-circlesadd-aspnet-mvc-3-ui-part.html
---

This post is part of a <a href="http://pragmatic-software.blogspot.com/2012/01/simple-circlesintroduction.html">series</a> on building a simple to use web-based contact and customer relationship management application. The goal is to support various audiences including businesses, teams, clubs, religious organizations, etc.<br />Last time I left off with a working fake implementation of the IPartyRepository called FakePartyRepository. We know that it is “working” because of the unit tests project that exercised the various methods of the contract. Since I have a working repository I’m going to start building out an ASP.NET MVC 3 website that will use the repository. My experience is that doing so earlier in the development cycle rather than later will flush out any problems or misaligned requirements. Remember, to this point I’ve been operating in something of a vacuum – building interfaces and implementations according to a vague vision of consuming them. Now I will make that vision concrete by constructing a user interface to work with.<br /><h2>Setup</h2>Using the New Project wizard, I added an ASP.NET MVC 3 website and chose “Internet Application” for the template with Razor as the view engine. I <u>did not</u> elect to create unit tests as I’m using xUnit and the template support is not worth setting up according to <a href="http://xunit.codeplex.com/discussions/272171" target="_blank">this</a> discussion post. At this point pressing &lt;F5&gt; will bring up the default empty website.<br /><a href="http://lh4.ggpht.com/-C33vsUmOiZ8/TwHS-sS09aI/AAAAAAAAAYs/-qcgmRT54T4/s1600-h/Simple-Circles---MVC-Scaffolding2.png"><img align="right" alt="Simple Circles - MVC Scaffolding" border="0" height="139" src="http://lh5.ggpht.com/-WD0dWewT6_M/TwHS-wWEQYI/AAAAAAAAAY0/lzTFRXaEL9I/Simple-Circles---MVC-Scaffolding_thu.png?imgmax=800" style="background-image: none; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px; display: inline; float: right; margin: 0px 0px 0px 5px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="Simple Circles - MVC Scaffolding" width="244" /></a>I’m a big fan of Steve Sanderson’s <a href="http://www.blogger.com/%3Ca%20href=%22http://www.amazon.com/gp/product/B005PZ07US/ref=as_li_qf_sp_asin_tl?ie=UTF8&amp;tag=wsl-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=B005PZ07US%22%3EPro%20ASP.NET%20MVC%203%20Framework%3C/a%3E%3Cimg%20src=%22http://www.assoc-amazon.com/e/ir?t=wsl-20&amp;l=as2&amp;o=1&amp;a=B005PZ07US%22%20width=%221%22%20height=%221%22%20border=%220%22%20alt=%22%22%20style=%22border:none%20!important;%20margin:0px%20!important;%22%20/%3E" target="_blank">Pro ASP.NET MVC Framework</a> books as well as his work on the <a href="http://blog.stevensanderson.com/2011/01/13/scaffold-your-aspnet-mvc-3-project-with-the-mvcscaffolding-package/" target="_blank">MVC Scaffolding</a> project which I started using last January as soon as he began publishing it. Therefore, I’m going to draw on his work to move things along quickly. First, I installed the scaffolding project using ‘<span style="font-family: 'Courier New';">install-package mvcscaffolding</span>’ which in turn brought in several dependencies as shown on the right.<br />I’ll also start off simple by using <a href="http://go.microsoft.com/fwlink/?LinkID=103197" target="_blank">SQL Server Compact 4.0</a> along with the new <a href="http://nuget.org/packages/System.Web.Providers" target="_blank">ASP.NET Universal Providers 1.01</a>. You can follow <a href="http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx" target="_blank">Scott Hanselman</a>’s or <a href="http://weblogs.asp.net/scottgu/archive/2011/01/11/vs-2010-sp1-and-sql-ce.aspx" target="_blank">Scott Guthrie</a>’s posts on setting it up.<br /><h2>Person</h2>MVC Scaffolding works off a model so first I added a Person class to the Models folder…<br /><pre class="c-sharp" name="code">namespace Circles.Models<br />{<br />  using System;<br />  using System.ComponentModel.DataAnnotations;<br /><br />  /// &lt;summary&gt;<br />  /// Represents a view model of a Person<br />  /// &lt;/summary&gt;<br />  public class Person<br />  {<br />    /// &lt;summary&gt;<br />    /// Default constructor<br />    /// &lt;/summary&gt;<br />    /// &lt;remarks&gt;Ensure Gender has a default value.&lt;/remarks&gt;<br />    public Person()<br />    {<br />      this.Gender = "Unknown";<br />    }<br /><br />    [Display(Name = "Person Id")]<br />    [Key]<br />    public Guid PersonId { get; set; }<br /><br />    [Display(Name = "Full name")]<br />    public string FullName { get; set; }<br /><br />    // [Required]<br />    [Display(Name = "Salutation")]<br />    [StringLength(20)]<br />    public string Salutation { get; set; }<br /><br />    [Required]<br />    [Display(Name = "First name")]<br />    [StringLength(50, MinimumLength = 3)]<br />    public string FirstName { get; set; }<br />  ...</pre><br /><a href="http://lh6.ggpht.com/-djmdmAyjB6I/TwHS_JBQsPI/AAAAAAAAAY8/vSwiH5NkOEs/s1600-h/Simple%252520Circles%252520-%252520Scaffold%252520Person%25255B2%25255D.png"><img align="right" alt="Simple Circles - Scaffold Person" border="0" height="126" src="http://lh6.ggpht.com/-CTyH6tEfFus/TwHS_R3j3MI/AAAAAAAAAZE/U2NA1od-JrQ/Simple%252520Circles%252520-%252520Scaffold%252520Person_thumb.png?imgmax=800" style="background-image: none; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px; display: inline; float: right; margin: 0px 0px 0px 5px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="Simple Circles - Scaffold Person" width="244" /></a>Now with a single NuGet instruction I scaffold a full CRUD interface for the model class using ‘<span style="font-family: 'Courier New';">scaffold controller PeopleController -ModelType Circles.Models.Person</span>’ as shown to the right. This one command generated an MVC controller class complete with all behaviors as well as a set of six Razor pages (Index to list, Details, Edit, Create, Delete, and a shared _CreateorEdit) to support CRUD behavior for a Person instance. As the second image shows, quite a bit of code was generated.<a href="http://lh3.ggpht.com/-Ovc9xGv254A/TwHS_euQjkI/AAAAAAAAAZM/jz8YV23iivQ/s1600-h/Simple%252520Circles%252520-%252520Scaffolded%252520Code%25255B2%25255D.png"><img align="right" alt="Simple Circles - Scaffolded Code" border="0" height="183" src="http://lh4.ggpht.com/-S8bfG7qcV50/TwHS_3-vELI/AAAAAAAAAZU/zsCZlQmhxow/Simple%252520Circles%252520-%252520Scaffolded%252520Code_thumb.png?imgmax=800" style="background-image: none; border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px; display: inline; float: right; margin: 5px 0px 0px 5px; padding-left: 0px; padding-right: 0px; padding-top: 0px;" title="Simple Circles - Scaffolded Code" width="244" /></a><br /><br />I can’t say enough about how exceedingly cool Steve’s scaffolding work is and how much effort it saves. Unfortunately, the current implementation is built to support Entity Framework as the underlying data technology. Notice the <span style="font-family: 'Courier New';">CirclesContext</span> class added to the Models folder and the reference to that context embedded in the <span style="font-family: 'Courier New';">PeopleController</span> class. While the hooks are there to plug in other scaffolding templates (e.g. NHibernate) as of yet nobody has stepped forward to provide implementations.<br /><br />You could also, as Steve suggests, add the Entity Framework 4.1 Code First capability via ‘<span style="font-family: 'Courier New';">install-package EFCodeFirst.SqlServerCompact</span>’ then regenerate the controller with the additional flags ‘<span style="font-family: 'Courier New';">-Repository –Force</span>’. You’d then have a working repository-based implementation built with all Microsoft products.<br /><br />In the second part of this installment I’ll take a different approach and wire in Ninject as the dependency injection framework then use it to inject the FakePartyRepository previously built.<br /><br />The source code for this article can be downloaded from <a href="http://simplecircles.codeplex.com/SourceControl/changeset/changes/1e517954dc75" target="_blank">here</a>.