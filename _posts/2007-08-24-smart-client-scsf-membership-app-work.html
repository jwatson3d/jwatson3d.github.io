---
layout: post
title: Smart Client (SCSF) Membership App - Work Items
date: '2007-08-24T22:03:00.000-04:00'
author: John
tags:
- CAB/SCSF
modified_time: '2010-09-05T19:52:58.768-04:00'
thumbnail: http://lh4.ggpht.com/_BvH8o_BvG-4/TIQtWtERoSI/AAAAAAAAAH0/ayhdiKdLSPk/s72-c/GS_PersonTabView_thumb%5B1%5D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-2811308028656623966.post-1802815981616394834
blogger_orig_url: http://pragmatic-software.blogspot.com/2007/08/smart-client-scsf-membership-app-work.html
---

<p>This post is part of a series which discusses the journey I took building a smart client membership application using Microsoft's <a href="http://msdn2.microsoft.com/en-us/library/aa480482.aspx">Smart Client Software Factory</a> (SCSF). You can navigate the entire series from <a href="http://pragmatic-software.blogspot.com/2007/08/building-smart-client-application-using.html">here</a>.</p> <p>Work Items are one of the SCSF/CAB artifacts that causes angst amongst smart client developers. Part of the problem lies with the early whitepaper <a href="http://msdn2.microsoft.com/en-us/library/bb266334.aspx">Architecting Composite Smart Clients Using CAB and SCSF</a> and the early CAB examples reflecting the thinking of the p&amp;p team at that time. The section entitled <em>Use-Case-Driven-Strategy</em> would have you create work items based upon each use case. In the banking case study, there would be 17 work items created! After pages and pages of details and diagrams on turning use cases into work items there's about half a page of text following that almost casually mentions another approach- mapping work items to business entities.  <p>In my membership application I took the business entity approach which I felt was reasonable, easier to develop, manage and it seems the p&amp;p team's thinking is also evolving. <a href="http://www.peterprovost.org/">Peter Provost</a>, Development Lead for the p&amp;p team, sums it up best in this <a href="http://www.ddj.com/windows/192203209">podcast</a> (sorry for their crappy, annoying splash ad!) - "there might not be enough value in creating that many work items". He goes on to say, "a work item is a scoping container" which David Platt echoes in his book, <a href="http://www.amazon.com/Programming-Microsoft-Composite-Application-Practices/dp/0735624143?ie=UTF8&amp;tag=wsl-20&amp;link_code=btl&amp;camp=213689&amp;creative=392969" target="_blank">Programming Microsoft Composite UI Application Block and Smart Client Software Factory (Pro-Best Practices)</a><img style="border-bottom-style: none !important; padding-bottom: 0px !important; border-right-style: none !important; margin: 0px; padding-left: 0px !important; padding-right: 0px !important; border-top-style: none !important; border-left-style: none !important; padding-top: 0px !important" border="0" alt="" src="http://www.assoc-amazon.com/e/ir?t=wsl-20&amp;l=btl&amp;camp=213689&amp;creative=392969&amp;o=1&amp;a=0735624143" width="1" height="1">*, equating a work item to a Win32 Process.  <p><a href="http://lh6.ggpht.com/_BvH8o_BvG-4/TIQtWKDtk8I/AAAAAAAAAHw/-8wVaW0GusI/s1600-h/GS_PersonTabView%5B3%5D.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; margin-left: 0px; border-top: 0px; margin-right: 0px; border-right: 0px" title="GS_PersonTabView" border="0" alt="GS_PersonTabView" align="right" src="http://lh4.ggpht.com/_BvH8o_BvG-4/TIQtWtERoSI/AAAAAAAAAH0/ayhdiKdLSPk/GS_PersonTabView_thumb%5B1%5D.png?imgmax=800" width="244" height="189"></a> Given the major business entities previously mentioned in this article series, it was natural for me to create a PersonWorkItem and HouseholdWorkItem. Each of these scopes the data, views and logic related to a specific business entity during runtime. There aren't any recipes for creating a work item so ya' gotta do it the old fashioned way - writing code by hand. Work Items are just simple classes that derive from Microsoft.Practices.CompositeUI.WorkItem. The example screen shot shown on the right contains a list of people on the left side. Clicking a person's name displays the person's information on the right side.  <p>The Members module contains a ModuleController class which is a specialized work item of type ControlledWorkItem - part of the recipe-generated code. I've added an EventSubscription there to respond to the person being chosen in the list view (see the <a href="http://wrbsoftware.com/LinkClick.aspx?link=62&amp;tabid=65">article about views</a> for more detail regarding the event handling specifics). Here's the logic that's executed within the event subscription:<pre class="csharp" name="code">  int personId = eventArgs.Data;<br><br>  //Create a key for the workitem so we can check<br>  //later if the workitem has already been created.<br>  string key = "Person" + personId;<br><br>  PersonWorkItem workItem = WorkItem.WorkItems.Get&lt;PersonWorkItem&gt;(key);<br><br>  if (workItem == null)<br>  {<br>      // add a new work item representing this instance to the <br>      // collection of work items in this module<br>      workItem = WorkItem.WorkItems.AddNew&lt;PersonWorkItem&gt;(key);<br><br>      // add a new detail view smart part to the collection of smart parts<br>      workItem.SmartParts.AddNew("PersonDetailView");<br><br>      workItem.Run(personId, WorkItem.Workspaces[WorkspaceNames.RightWorkspace]);</pre><br><br /><p>Remember, this code is in ModuleController.cs which is a work item so the reference <em>WorkItem.WorkItems</em> is the collection of work items within the ModuleController - <em>WorkItem</em> is a reference to the controller's work item and <em>WorkItems</em> is a collection within. Thus, I am attempting to retrieve the existing work item for the selected person and, if it doesn't exist, then a new PersonWorkItem is created and added to the ModuleController's collection of work items that it maintains. Therefore, each person selected for display causes a PersonWorkItem instance to be created and managed. Of course, how many get created and how they are disposed is up to you. In my case, since I'm using a TabWorkspace with one tab per person shown (see the bottom tabs on the above screen shot) I may have several PersonWorkItem instances managed in memory at once. <br><br /><p>As the comment shows above, a <em>PersonDetailView</em> smart part is created and added to the new <em>PersonWorkItem</em> instance's collection of smart parts it manages. The new <em>PersonWorkItem</em> instance's Run method is then called and the right hand workspace is passed as an argument telling it where to display itself. Additional smart parts are nested within the detail view using smart part placeholders and it all displays "like magic". <br><br /><p>The key concept here is how I scoped work relating to a business entity - a Person - within a work item. That work item instance contains a smart parts collection which holds all the views related to displaying a person as well as the logic and event handling that takes place when the user interacts with the views (a.k.a. smart parts). <br><br /><blockquote><br /><p>* David's book must be vying for the award of longest title for the thinnest technical book :). It is great as an overall introduction and I recommend it if you're just getting started in CAB/SCSF but the "programming" part is light compared to some programming books. Don't get me wrong - David is a gifted technical writer but if you're looking for a lot of meat and in-depth programming examples then you'll be disappointed. If you're looking for a good foundational understanding of SCSF before embarking on a project then by all means buy the book - I wish I had it when I started out but it was just published a couple of weeks before I wrote this article.</p></blockquote><br><br /><p><a href="http://geekswithblogs.net/jwatson/archive/2007/08/24/114957.aspx"><font size="1">Original post</font></a></p>  