---
layout: post
title: Turbo Pascal 6 circa 1992
date: '2012-05-02T22:54:00.000-04:00'
author: John Watson
excerpt: Found this old sample program written in Turbo Pascal 6. My recollection is that it would process a file received from a factory in Italy and print a report. Notice the first line of code  for declaring the amount of memory? Umm…those are BYTES in the first line, as in minimum of 8K, maximum of 384K...
tags:
- General
modified_time: '2012-05-02T22:54:24.759-04:00'
blogger_id: tag:blogger.com,1999:blog-2811308028656623966.post-628874135668621071
blogger_orig_url: http://pragmatic-software.blogspot.com/2012/05/turbo-pascal-6-circa-1992.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">Found this old sample program written in Turbo Pascal 6. My recollection is that it would process a file received from a factory in Italy and print a report. Notice the first line of code&nbsp; for declaring the amount of memory? Umm…those are BYTES in the first line, as in minimum of 8K, maximum of 384K<br /><br /><pre><span style="color: green;"><i>{$M 8192, 0, 384000}</i></span><br /><span style="color: green;"><i>{************************************************************<br />  Program:  ITALYSUM<br />  Purpose:  Print a list of styles with a summary by style<br />  Author :  John H. Watson III<br />  Compile:  Borland Turbo Pascal 6.0<br /><br />  Changed:  11/09/92 John Watson<br />            Use extended syntax on WriteLn to format numeric<br />              output right-adjusted. (e.g. "PairsNum:5"<br />              instead of just "PairsNum").<br /><br />  Changed:  11/15/92 John Watson<br />            Added style description to detail &amp; summary print.<br />            Removed hardcoding of field lengths in ProcessData<br />              and replaced with constants.<br />            Replaced hardcoded page titles with constants.<br />            Change test of result of collection from "&gt; 0"<br />              to "&lt;&gt; -1".  Zero is a valid location in the<br />              collection and IndexOf will return a -1 if the<br />              search doesn't find anything.<br /> ************************************************************}</i></span><br /><span style="color: red;"><b>PROGRAM</b></span> ITALYSUM<span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>USES</b></span> Dos<span style="color: blue;"><b>,</b></span> Printer<span style="color: blue;"><b>,</b></span> Objects<span style="color: blue;"><b>,</b></span> StdPrint<span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>CONST</b></span><br />  CopyrightText <span style="color: blue;">=</span> <span style="color: purple;">'Copyright (c) 1992 by John H. Watson III'</span><span style="color: blue;"><b>;</b></span><br />  DetailTitle  <span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span> <span style="color: blue;">=</span> <span style="color: purple;">'Italy Data File Listing - Detail'</span><span style="color: blue;"><b>;</b></span><br />  SummaryTitle <span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span> <span style="color: blue;">=</span> <span style="color: purple;">'Italy Data File Listing - Summary'</span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>VAR</b></span><br />  CopyrightStr <span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>[</b></span><span style="color: brown;">40</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>CONST</b></span><br />  MaxLines <span style="color: blue;">=</span> <span style="color: brown;">60</span><span style="color: blue;"><b>;</b></span><br />  Pagesize <span style="color: blue;">=</span> <span style="color: brown;">66</span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: green;"><i>{********************************************************************<br />  Define Objects<br /> ********************************************************************}</i></span><br /><br /><span style="color: red;"><b>TYPE</b></span><br />  pSummary <span style="color: blue;">=</span> <span style="color: cyan;"><span style="color: blue;">^</span>TSummary</span><span style="color: blue;"><b>;</b></span><br />  TSummary <span style="color: blue;">=</span> <span style="color: red;"><b>OBJECT</b></span><span style="color: blue;"><b>(</b></span>TObject<span style="color: blue;"><b>)</b></span><br />    Pairs <span style="color: blue;"><b>:</b></span> Integer<span style="color: blue;"><b>;</b></span><br />    Style <span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>[</b></span><span style="color: brown;">10</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>;</b></span><br />    SDesc <span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>[</b></span><span style="color: brown;">30</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>;</b></span><br />    <span style="color: red;"><b>CONSTRUCTOR</b></span> Init<span style="color: blue;"><b>(</b></span>iPairs<span style="color: blue;"><b>:</b></span> Integer<span style="color: blue;"><b>;</b></span> iStyle<span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>;</b></span> iSDesc<span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    <span style="color: red;"><b>PROCEDURE</b></span> Print<span style="color: blue;"><b>;</b></span><br />    <span style="color: red;"><b>PROCEDURE</b></span> Accumulate<span style="color: blue;"><b>(</b></span>iPairs<span style="color: blue;"><b>:</b></span> Integer<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  <span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br /><br />  PStyleSummary <span style="color: blue;">=</span> <span style="color: cyan;"><span style="color: blue;">^</span>TStyleSummary</span><span style="color: blue;"><b>;</b></span><br />  TStyleSummary <span style="color: blue;">=</span> <span style="color: red;"><b>OBJECT</b></span><span style="color: blue;"><b>(</b></span>TSortedCollection<span style="color: blue;"><b>)</b></span><br />    <span style="color: red;"><b>FUNCTION</b></span> KeyOf<span style="color: blue;"><b>(</b></span>Item<span style="color: blue;"><b>:</b></span> Pointer<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>:</b></span> Pointer<span style="color: blue;"><b>;</b></span> VIRTUAL<span style="color: blue;"><b>;</b></span><br />    <span style="color: red;"><b>FUNCTION</b></span> Compare<span style="color: blue;"><b>(</b></span>Key1<span style="color: blue;"><b>,</b></span> Key2<span style="color: blue;"><b>:</b></span> Pointer<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>:</b></span> Integer<span style="color: blue;"><b>;</b></span> VIRTUAL<span style="color: blue;"><b>;</b></span><br />  <span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: green;"><i>{********************************************************************<br />  Global Variables<br /> ********************************************************************}</i></span><br /><br /><span style="color: red;"><b>VAR</b></span><br />  ErrorCode   <span style="color: blue;"><b>:</b></span> Integer<span style="color: blue;"><b>;</b></span><br />  F           <span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>File</b></span><span style="color: blue;"><b>;</b></span><br />  GrandTotal  <span style="color: blue;"><b>:</b></span> Longint<span style="color: blue;"><b>;</b></span><br />  Path        <span style="color: blue;"><b>:</b></span> PathStr<span style="color: blue;"><b>;</b></span><br />  SummaryList <span style="color: blue;"><b>:</b></span> pStyleSummary<span style="color: blue;"><b>;</b></span>  <span style="color: green;"><i>{ define global instance }</i></span><br /><br /><span style="color: red;"><b>VAR</b></span><br />  FTime       <span style="color: blue;"><b>:</b></span> Longint<span style="color: blue;"><b>;</b></span>        <span style="color: green;"><i>{ file time }</i></span><br />  FDT         <span style="color: blue;"><b>:</b></span> DateTime<span style="color: blue;"><b>;</b></span>       <span style="color: green;"><i>{ DOS' date/time record structure }</i></span><br /><br /><span style="color: green;"><i>{********************************************************************<br />  TSummary Object Methods<br /> ********************************************************************}</i></span><br /><br /><span style="color: red;"><b>CONSTRUCTOR</b></span> TSummary<span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Init<span style="color: blue;"><b>(</b></span>iPairs<span style="color: blue;"><b>:</b></span> Integer<span style="color: blue;"><b>;</b></span> iStyle<span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>;</b></span> iSDesc<span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>BEGIN</b></span><br />  TObject<span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Init<span style="color: blue;"><b>;</b></span>         <span style="color: green;"><i>{ call ancestor's init first }</i></span><br />  Pairs <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> iPairs<span style="color: blue;"><b>;</b></span><br />  Style <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> iStyle<span style="color: blue;"><b>;</b></span><br />  SDesc <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> iSDesc<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>PROCEDURE</b></span> TSummary<span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Accumulate<span style="color: blue;"><b>(</b></span>iPairs<span style="color: blue;"><b>:</b></span> Integer<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>BEGIN</b></span><br />  Pairs <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> Pairs <span style="color: blue;">+</span> iPairs<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>PROCEDURE</b></span> TSummary<span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Print<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>BEGIN</b></span><br />  WRITELN<span style="color: blue;"><b>(</b></span>LST<span style="color: blue;"><b>,</b></span>Pairs<span style="color: blue;"><b>:</b></span><span style="color: brown;">5</span><span style="color: blue;"><b>,</b></span> <span style="color: purple;">' '</span><span style="color: blue;"><b>,</b></span> Style<span style="color: blue;"><b>,</b></span> <span style="color: purple;">' '</span><span style="color: blue;"><b>,</b></span> SDesc<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: green;"><i>{********************************************************************<br />  TStyleSummary Methods<br /> ********************************************************************}</i></span><br /><br />    <span style="color: green;"><i>{ Define the key field for the collection.  Since KeyOf expects<br />      a pointer and Style is a simple string we must use the "@"<br />      (address of) operator to generate the address (pointer).  If<br />      Style was a pString, this would not be necessary. }</i></span><br /><br /><span style="color: red;"><b>FUNCTION</b></span> TStyleSummary<span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>KeyOf<span style="color: blue;"><b>(</b></span>Item<span style="color: blue;"><b>:</b></span> Pointer<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>:</b></span> Pointer<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>BEGIN</b></span><br />  KeyOf <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> <span style="color: blue;">@</span>pSummary<span style="color: blue;"><b>(</b></span>Item<span style="color: blue;"><b>)</b></span><span style="color: blue;">^</span><span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Style<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>FUNCTION</b></span> TStyleSummary<span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Compare<span style="color: blue;"><b>(</b></span>Key1<span style="color: blue;"><b>,</b></span> Key2<span style="color: blue;"><b>:</b></span> Pointer<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>:</b></span> Integer<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>BEGIN</b></span><br />  <span style="color: red;"><b>IF</b></span> pString<span style="color: blue;"><b>(</b></span>Key1<span style="color: blue;"><b>)</b></span><span style="color: blue;">^</span> <span style="color: blue;">=</span> pString<span style="color: blue;"><b>(</b></span>Key2<span style="color: blue;"><b>)</b></span><span style="color: blue;">^</span> <span style="color: red;"><b>THEN</b></span><br />    Compare <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> <span style="color: brown;">0</span><br />  <span style="color: red;"><b>ELSE</b></span> <span style="color: red;"><b>IF</b></span> pString<span style="color: blue;"><b>(</b></span>Key1<span style="color: blue;"><b>)</b></span><span style="color: blue;">^</span> <span style="color: blue;">&lt;</span> pString<span style="color: blue;"><b>(</b></span>Key2<span style="color: blue;"><b>)</b></span><span style="color: blue;">^</span> <span style="color: red;"><b>THEN</b></span><br />         Compare <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> <span style="color: blue;">-</span><span style="color: brown;">1</span><br />       <span style="color: red;"><b>ELSE</b></span><br />         Compare <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> <span style="color: blue;">+</span><span style="color: brown;">1</span><span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: green;"><i>{********************************************************************<br />  Miscellaneous Procedures and Functions<br /> ********************************************************************}</i></span><br /><br /><span style="color: red;"><b>FUNCTION</b></span> OpenFile<span style="color: blue;"><b>(</b></span><span style="color: red;"><b>VAR</b></span> F<span style="color: blue;"><b>:</b></span><span style="color: red;"><b>File</b></span><span style="color: blue;"><b>;</b></span> iName<span style="color: blue;"><b>:</b></span>PathStr<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>:</b></span> BOOLEAN<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>BEGIN</b></span><br />    ASSIGN<span style="color: blue;"><b>(</b></span>F<span style="color: blue;"><b>,</b></span> iName<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    <span style="color: green;"><i>{$I-}</i></span> RESET<span style="color: blue;"><b>(</b></span>F<span style="color: blue;"><b>,</b></span> <span style="color: brown;">1</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span> <span style="color: green;"><i>{$I+}</i></span><br />    OpenFile <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> IOResult <span style="color: blue;">=</span> <span style="color: brown;">0</span><span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>END</b></span> <span style="color: green;"><i>{Open}</i></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>PROCEDURE</b></span> Initialize<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>VAR</b></span><br />  Dir  <span style="color: blue;"><b>:</b></span> DirStr<span style="color: blue;"><b>;</b></span><br />  Name <span style="color: blue;"><b>:</b></span> NameStr<span style="color: blue;"><b>;</b></span><br />  Extn <span style="color: blue;"><b>:</b></span> ExtStr<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>BEGIN</b></span><br />  CopyrightStr <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> CopyrightText<span style="color: blue;"><b>;</b></span><br />  <span style="color: red;"><b>IF</b></span> ParamCount <span style="color: blue;">=</span> <span style="color: brown;">0</span><br />    <span style="color: red;"><b>THEN</b></span> Path <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> <span style="color: purple;">'ITALYDTA'</span><br />    <span style="color: red;"><b>ELSE</b></span> Path <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> ParamStr<span style="color: blue;"><b>(</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  Path <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> FExpand<span style="color: blue;"><b>(</b></span>Path<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span>  <span style="color: green;"><i>{ expand into full path string }</i></span><br />  FSplit<span style="color: blue;"><b>(</b></span>Path<span style="color: blue;"><b>,</b></span> Dir<span style="color: blue;"><b>,</b></span> Name<span style="color: blue;"><b>,</b></span> Extn<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span>  <span style="color: green;"><i>{ split into components }</i></span><br />  <span style="color: red;"><b>IF</b></span> <span style="color: blue;"><b>(</b></span>Name <span style="color: blue;">=</span> <span style="color: purple;">''</span><span style="color: blue;"><b>)</b></span> <span style="color: red;"><b>OR</b></span> <span style="color: red;"><b>NOT</b></span> OpenFile<span style="color: blue;"><b>(</b></span>F<span style="color: blue;"><b>,</b></span> Path<span style="color: blue;"><b>)</b></span> <span style="color: red;"><b>THEN</b></span> <span style="color: red;"><b>BEGIN</b></span><br />    WRITELN<span style="color: blue;"><b>(</b></span><span style="color: purple;">'ERROR:  File not found ('</span><span style="color: blue;"><b>,</b></span> Name<span style="color: blue;"><b>,</b></span> <span style="color: purple;">').'</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    HALT<span style="color: blue;"><b>(</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    <span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br />  GetFTime<span style="color: blue;"><b>(</b></span>F<span style="color: blue;"><b>,</b></span> FTime<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  UnpackTime<span style="color: blue;"><b>(</b></span>FTime<span style="color: blue;"><b>,</b></span> FDT<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  GrandTotal <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> <span style="color: brown;">0</span><span style="color: blue;"><b>;</b></span><br />  LineCount <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> PageSize<span style="color: blue;"><b>;</b></span><br />  SummaryList <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> New<span style="color: blue;"><b>(</b></span>pStyleSummary<span style="color: blue;"><b>,</b></span> Init<span style="color: blue;"><b>(</b></span><span style="color: brown;">200</span><span style="color: blue;"><b>,</b></span> <span style="color: brown;">50</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span> <span style="color: green;"><i>{ create collection }</i></span><br /><span style="color: red;"><b>END</b></span> <span style="color: green;"><i>{Initialize}</i></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>PROCEDURE</b></span> Terminate<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>BEGIN</b></span><br />  Close<span style="color: blue;"><b>(</b></span>F<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  Close<span style="color: blue;"><b>(</b></span>LST<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  Dispose<span style="color: blue;"><b>(</b></span>SummaryList<span style="color: blue;"><b>,</b></span> Done<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>PROCEDURE</b></span> PrintHeading<span style="color: blue;"><b>(</b></span>iTitle<span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>BEGIN</b></span><br />  <span style="color: red;"><b>IF</b></span> <span style="color: red;"><b>NOT</b></span> FirstPrint <span style="color: red;"><b>THEN</b></span> EjectPage<span style="color: blue;"><b>;</b></span><br />  VerticalTab<span style="color: blue;"><b>(</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  WriteLn<span style="color: blue;"><b>(</b></span>LST<span style="color: blue;"><b>,</b></span> iTitle<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  VerticalTab<span style="color: blue;"><b>(</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  <span style="color: red;"><b>IF</b></span> FirstPrint <span style="color: red;"><b>THEN</b></span> <span style="color: red;"><b>BEGIN</b></span><br />     WriteLn<span style="color: blue;"><b>(</b></span>LST<span style="color: blue;"><b>,</b></span> <span style="color: purple;">'File: '</span><span style="color: blue;"><b>,</b></span> Path<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />     WriteLn<span style="color: blue;"><b>(</b></span>LST<span style="color: blue;"><b>,</b></span> <span style="color: purple;">'Date: '</span><span style="color: blue;"><b>,</b></span>FDT<span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Month<span style="color: blue;"><b>,</b></span><span style="color: purple;">'/'</span><span style="color: blue;"><b>,</b></span>FDT<span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Day<span style="color: blue;"><b>,</b></span><span style="color: purple;">'/'</span><span style="color: blue;"><b>,</b></span>FDT<span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Year<span style="color: blue;"><b>,</b></span><br />                <span style="color: purple;">'  Time: '</span><span style="color: blue;"><b>,</b></span>FDT<span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Hour<span style="color: blue;"><b>,</b></span><span style="color: purple;">':'</span><span style="color: blue;"><b>,</b></span>FDT<span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Min<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />     VerticalTab<span style="color: blue;"><b>(</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />     <span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br />  <span style="color: red;"><b>IF</b></span> FirstPrint<br />     <span style="color: red;"><b>THEN</b></span> LineCount <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> <span style="color: brown;">6</span><br />     <span style="color: red;"><b>ELSE</b></span> LineCount <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> LineCount <span style="color: blue;">+</span> <span style="color: brown;">3</span><span style="color: blue;"><b>;</b></span><br />  FirstPrint <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> False<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br /><br />    <span style="color: green;"><i>{ Use ForEach iterator to display Summary information }</i></span><br /><br /><span style="color: red;"><b>PROCEDURE</b></span> PrintSummary<span style="color: blue;"><b>;</b></span><br />    <span style="color: red;"><b>PROCEDURE</b></span> PrintSummaryObject<span style="color: blue;"><b>(</b></span>p <span style="color: blue;"><b>:</b></span> pSummary<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span> FAR<span style="color: blue;"><b>;</b></span><br />    <span style="color: red;"><b>BEGIN</b></span><br />      <span style="color: red;"><b>IF</b></span> LineCount <span style="color: blue;">&gt;</span><span style="color: blue;">=</span> MaxLines <span style="color: red;"><b>THEN</b></span> <span style="color: red;"><b>BEGIN</b></span><br />         PrintHeading<span style="color: blue;"><b>(</b></span>SummaryTitle<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />         WriteLn<span style="color: blue;"><b>(</b></span>LST<span style="color: blue;"><b>,</b></span> <span style="color: purple;">'Pairs Style      Description'</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />         WriteLn<span style="color: blue;"><b>(</b></span>LST<span style="color: blue;"><b>,</b></span> <span style="color: purple;">'----- ---------- -----------'</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />         VerticalTab<span style="color: blue;"><b>(</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />         LineCount <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> LineCount <span style="color: blue;">+</span> <span style="color: brown;">3</span><span style="color: blue;"><b>;</b></span><br />         <span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br />      p<span style="color: blue;">^</span><span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Print<span style="color: blue;"><b>;</b></span>   <span style="color: green;"><i>{ Call object's print method }</i></span><br />      GrandTotal <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> GrandTotal <span style="color: blue;">+</span> p<span style="color: blue;">^</span><span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Pairs<span style="color: blue;"><b>;</b></span><br />      LineCount <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> LineCount <span style="color: blue;">+</span> <span style="color: brown;">1</span><span style="color: blue;"><b>;</b></span><br />    <span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>BEGIN</b></span><br />  LineCount <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> MaxLines<span style="color: blue;"><b>;</b></span> <span style="color: green;"><i>{ force initial headings to print }</i></span><br />  SummaryList<span style="color: blue;">^</span><span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>ForEach<span style="color: blue;"><b>(</b></span><span style="color: blue;">@</span>PrintSummaryObject<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  VerticalTab<span style="color: blue;"><b>(</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  WriteLn<span style="color: blue;"><b>(</b></span>LST<span style="color: blue;"><b>,</b></span> GrandTotal<span style="color: blue;"><b>:</b></span><span style="color: brown;">5</span><span style="color: blue;"><b>,</b></span> <span style="color: purple;">' Grand Total'</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  EjectPage<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br /><br />  <span style="color: green;"><i>{ This procedure will read enough bytes to fill a record buffer.<br />    Since the record length exceeds 255 bytes, we cannot use ReadLn to<br />    read a record.  To overcome this, the file is processed as an untyped<br />    file and BlockRead is used to fill the buffer. }</i></span><br /><br /><span style="color: red;"><b>PROCEDURE</b></span> ProcessData<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>CONST</b></span><br />  PairsPos  <span style="color: blue;"><b>:</b></span> Integer <span style="color: blue;">=</span> <span style="color: brown;">578</span><span style="color: blue;"><b>;</b></span>  PairsLen <span style="color: blue;"><b>:</b></span> Integer <span style="color: blue;">=</span> <span style="color: brown;">5</span><span style="color: blue;"><b>;</b></span><br />  OrdNoPos  <span style="color: blue;"><b>:</b></span> Integer <span style="color: blue;">=</span> <span style="color: brown;">2</span><span style="color: blue;"><b>;</b></span>    OrdNoLen <span style="color: blue;"><b>:</b></span> Integer <span style="color: blue;">=</span> <span style="color: brown;">9</span><span style="color: blue;"><b>;</b></span><br />  RegNoPos  <span style="color: blue;"><b>:</b></span> Integer <span style="color: blue;">=</span> <span style="color: brown;">131</span><span style="color: blue;"><b>;</b></span>  RegNoLen <span style="color: blue;"><b>:</b></span> Integer <span style="color: blue;">=</span> <span style="color: brown;">6</span><span style="color: blue;"><b>;</b></span><br />  SDescPos  <span style="color: blue;"><b>:</b></span> Integer <span style="color: blue;">=</span> <span style="color: brown;">588</span><span style="color: blue;"><b>;</b></span>  SDescLen <span style="color: blue;"><b>:</b></span> Integer <span style="color: blue;">=</span> <span style="color: brown;">30</span><span style="color: blue;"><b>;</b></span><br />  StylePos  <span style="color: blue;"><b>:</b></span> Integer <span style="color: blue;">=</span> <span style="color: brown;">313</span><span style="color: blue;"><b>;</b></span>  StyleLen <span style="color: blue;"><b>:</b></span> Integer <span style="color: blue;">=</span> <span style="color: brown;">10</span><span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>VAR</b></span><br />  Buffer    <span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>ARRAY</b></span><span style="color: blue;"><b>[</b></span>1<span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span><span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>905<span style="color: blue;"><b>]</b></span> <span style="color: red;"><b>OF</b></span> Char<span style="color: blue;"><b>;</b></span> <span style="color: green;"><i>{ includes two extra bytes for CR/LF }</i></span><br />  BytesRead <span style="color: blue;"><b>:</b></span> Word<span style="color: blue;"><b>;</b></span><br />  Location  <span style="color: blue;"><b>:</b></span> Integer<span style="color: blue;"><b>;</b></span>  <span style="color: green;"><i>{ location in collection of existing summary object }</i></span><br />  NewObj<span style="color: blue;"><b>,</b></span> OldObj <span style="color: blue;"><b>:</b></span> pSummary<span style="color: blue;"><b>;</b></span><br />  PairsNum  <span style="color: blue;"><b>:</b></span> Integer<span style="color: blue;"><b>;</b></span><br />  PairsStr  <span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>[</b></span><span style="color: brown;">5</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>;</b></span><br />  OrdNo     <span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>[</b></span><span style="color: brown;">9</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>;</b></span><br />  RegNo     <span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>[</b></span><span style="color: brown;">6</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>;</b></span><br />  Style     <span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>[</b></span><span style="color: brown;">10</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>;</b></span><br />  SDesc     <span style="color: blue;"><b>:</b></span> <span style="color: red;"><b>String</b></span><span style="color: blue;"><b>[</b></span><span style="color: brown;">30</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>BEGIN</b></span><br />  BlockRead<span style="color: blue;"><b>(</b></span>F<span style="color: blue;"><b>,</b></span> Buffer<span style="color: blue;"><b>,</b></span> SizeOf<span style="color: blue;"><b>(</b></span>Buffer<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>,</b></span> BytesRead<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />  <span style="color: red;"><b>WHILE</b></span> <span style="color: blue;"><b>(</b></span><span style="color: red;"><b>NOT</b></span> EOF<span style="color: blue;"><b>(</b></span>F<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>)</b></span> <span style="color: red;"><b>DO</b></span> <span style="color: red;"><b>BEGIN</b></span><br /><br />      <span style="color: green;"><i>{ Extract individual fields from record buffer }</i></span><br />    Move<span style="color: blue;"><b>(</b></span>Buffer<span style="color: blue;"><b>[</b></span>StylePos<span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>,</b></span> Style<span style="color: blue;"><b>[</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>,</b></span> StyleLen<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    Style<span style="color: blue;"><b>[</b></span><span style="color: brown;">0</span><span style="color: blue;"><b>]</b></span> <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> Char<span style="color: blue;"><b>(</b></span>StyleLen<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span>             <span style="color: green;"><i>{ force the proper string size }</i></span><br />    Move<span style="color: blue;"><b>(</b></span>Buffer<span style="color: blue;"><b>[</b></span>SDescPos<span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>,</b></span> SDesc<span style="color: blue;"><b>[</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>,</b></span> SDescLen<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    SDesc<span style="color: blue;"><b>[</b></span><span style="color: brown;">0</span><span style="color: blue;"><b>]</b></span> <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> Char<span style="color: blue;"><b>(</b></span>SDescLen<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    Move<span style="color: blue;"><b>(</b></span>Buffer<span style="color: blue;"><b>[</b></span>OrdNoPos<span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>,</b></span> OrdNo<span style="color: blue;"><b>[</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>,</b></span> OrdNoLen<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    OrdNo<span style="color: blue;"><b>[</b></span><span style="color: brown;">0</span><span style="color: blue;"><b>]</b></span> <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> Char<span style="color: blue;"><b>(</b></span>OrdNoLen<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    Move<span style="color: blue;"><b>(</b></span>Buffer<span style="color: blue;"><b>[</b></span>RegNoPos<span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>,</b></span> RegNo<span style="color: blue;"><b>[</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>,</b></span> RegNoLen<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    RegNo<span style="color: blue;"><b>[</b></span><span style="color: brown;">0</span><span style="color: blue;"><b>]</b></span> <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> Char<span style="color: blue;"><b>(</b></span>RegNoLen<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    Move<span style="color: blue;"><b>(</b></span>Buffer<span style="color: blue;"><b>[</b></span>PairsPos<span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>,</b></span> PairsStr<span style="color: blue;"><b>[</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>]</b></span><span style="color: blue;"><b>,</b></span> PairsLen<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    PairsStr<span style="color: blue;"><b>[</b></span><span style="color: brown;">0</span><span style="color: blue;"><b>]</b></span> <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> Char<span style="color: blue;"><b>(</b></span>PairsLen<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    Val<span style="color: blue;"><b>(</b></span>PairsStr<span style="color: blue;"><b>,</b></span> PairsNum<span style="color: blue;"><b>,</b></span> ErrorCode<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span>  <span style="color: green;"><i>{ convert string to numeric }</i></span><br /><br />      <span style="color: green;"><i>{ Print detail line }</i></span><br />    <span style="color: red;"><b>IF</b></span> LineCount <span style="color: blue;">&gt;</span><span style="color: blue;">=</span> MaxLines <span style="color: red;"><b>THEN</b></span> <span style="color: red;"><b>BEGIN</b></span><br />       PrintHeading<span style="color: blue;"><b>(</b></span>DetailTitle<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />       WriteLn<span style="color: blue;"><b>(</b></span>LST<span style="color: blue;"><b>,</b></span> <span style="color: purple;">'Order No  Reg No Pairs Style      Description'</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />       WriteLn<span style="color: blue;"><b>(</b></span>LST<span style="color: blue;"><b>,</b></span> <span style="color: purple;">'--------- ------ ----- ---------- -----------'</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />       VerticalTab<span style="color: blue;"><b>(</b></span><span style="color: brown;">1</span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />       LineCount <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> LineCount <span style="color: blue;">+</span> <span style="color: brown;">3</span><span style="color: blue;"><b>;</b></span><br />       <span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br />    WRITELN<span style="color: blue;"><b>(</b></span>LST<span style="color: blue;"><b>,</b></span> OrdNo<span style="color: blue;"><b>,</b></span> <span style="color: purple;">' '</span><span style="color: blue;"><b>,</b></span> RegNo<span style="color: blue;"><b>,</b></span> <span style="color: purple;">' '</span><span style="color: blue;"><b>,</b></span> PairsNum<span style="color: blue;"><b>:</b></span><span style="color: brown;">5</span><span style="color: blue;"><b>,</b></span> <span style="color: purple;">' '</span><span style="color: blue;"><b>,</b></span> Style<span style="color: blue;"><b>,</b></span> <span style="color: purple;">' '</span><span style="color: blue;"><b>,</b></span> SDesc<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    LineCount <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> LineCount <span style="color: blue;">+</span> <span style="color: brown;">1</span><span style="color: blue;"><b>;</b></span><br /><br />      <span style="color: green;"><i>{ Now create a new instance of a summary object with these values }</i></span><br />    NewObj <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> New<span style="color: blue;"><b>(</b></span>pSummary<span style="color: blue;"><b>,</b></span> Init<span style="color: blue;"><b>(</b></span>PairsNum<span style="color: blue;"><b>,</b></span> Style<span style="color: blue;"><b>,</b></span> SDesc<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br /><br />      <span style="color: green;"><i>{ Search the collection to see if it already exists }</i></span><br />    Location <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> SummaryList<span style="color: blue;">^</span><span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>IndexOf<span style="color: blue;"><b>(</b></span>NewObj<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    <span style="color: red;"><b>IF</b></span> Location <span style="color: blue;">&lt;</span><span style="color: blue;">&gt;</span> <span style="color: blue;">-</span><span style="color: brown;">1</span> <span style="color: red;"><b>THEN</b></span> <span style="color: red;"><b>BEGIN</b></span>    <span style="color: green;"><i>{ If found, accumulate pairs }</i></span><br />       OldObj <span style="color: blue;"><b>:</b></span><span style="color: blue;">=</span> SummaryList<span style="color: blue;">^</span><span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>AT<span style="color: blue;"><b>(</b></span>Location<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span> <span style="color: green;"><i>{ get ptr to obj @ location }</i></span><br />       OldObj<span style="color: blue;">^</span><span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Accumulate<span style="color: blue;"><b>(</b></span>PairsNum<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span> <span style="color: green;"><i>{ call that obj's accumulate method }</i></span><br />       <span style="color: red;"><b>END</b></span><br />    <span style="color: red;"><b>ELSE</b></span> SummaryList<span style="color: blue;">^</span><span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span>Insert<span style="color: blue;"><b>(</b></span>NewObj<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span> <span style="color: green;"><i>{ else add to collection }</i></span><br /><br />    BlockRead<span style="color: blue;"><b>(</b></span>F<span style="color: blue;"><b>,</b></span> Buffer<span style="color: blue;"><b>,</b></span> SizeOf<span style="color: blue;"><b>(</b></span>Buffer<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>,</b></span> BytesRead<span style="color: blue;"><b>)</b></span><span style="color: blue;"><b>;</b></span><br />    <span style="color: red;"><b>END</b></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>END</b></span> <span style="color: green;"><i>{ProcessData}</i></span><span style="color: blue;"><b>;</b></span><br /><br /><span style="color: red;"><b>BEGIN</b></span><br />  Initialize<span style="color: blue;"><b>;</b></span><br />  ProcessData<span style="color: blue;"><b>;</b></span><br />  PrintSummary<span style="color: blue;"><b>;</b></span><br />  Terminate<span style="color: blue;"><b>;</b></span><br /><span style="color: red;"><b>END</b></span><span style="color: blue;"><b><span style="color: blue;"><b>.</b></span></b></span></pre></div>